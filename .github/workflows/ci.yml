---
# CI workflow using ci-framework reusable workflow
# Replaces standalone jobs with centralized, maintained ci-framework patterns
name: CI

on:
  push:
    branches: [main, development]
  pull_request:
    branches: [main, development]
  workflow_dispatch:

jobs:
  # Main CI workflow using ci-framework reusable workflow
  ci:
    name: "CI (Framework)"
    uses: Claire-s-Monster/ci-framework/.github/workflows/pixi-ci.yml@main
    with:
      # Pixi configuration
      pixi_version: "v0.39.0"
      pixi_environment: "ci"

      # Enable all quality gates
      run_hygiene: true
      run_quality: true
      run_tests: true

      # Change detection for optimization
      enable_change_detection: true

      # Project-specific configuration
      python_version: "3.11"

    secrets: inherit

  # Legacy compatibility: Keep ci-success job for branch protection rules
  ci-success:
    name: "CI Success"
    runs-on: ubuntu-latest
    needs: [ci]
    if: always()
    steps:
      - name: "Check CI workflow passed"
        run: |
          if [ "${{ needs.ci.result }}" != "success" ]; then
            echo "CI framework workflow failed"
            exit 1
          fi
          echo "All CI checks passed via ci-framework!"
