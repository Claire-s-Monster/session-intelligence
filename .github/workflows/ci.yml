---
# CI workflow using ci-framework reusable workflow directly
name: CI

on:
  push:
    branches: [main, development]
  pull_request:
    branches: [main, development]
  workflow_dispatch:

jobs:
  ci:
    uses: Claire-s-Monster/ci-framework/.github/workflows/reusable-ci.yml@v2.4.1
    with:
      pixi-environment: "ci"
      python-versions: '["3.11", "3.12"]'
      os-matrix: '["ubuntu-latest"]'
      enable-performance: false
      enable-release: false
      enable-hygiene-check: true
      editable-install: true
      package-path: "."
      allowed-licenses: "MIT, Apache-2.0, BSD-3-Clause, BSD-2-Clause, PSF-2.0, LGPL-3.0"
    secrets: inherit

  # Branch protection gate
  ci-success:
    name: "CI Success"
    runs-on: ubuntu-latest
    needs: [ci]
    if: always()
    steps:
      - name: "Check CI workflow passed"
        run: |
          if [ "${{ needs.ci.result }}" != "success" ]; then
            echo "CI framework workflow failed"
            exit 1
          fi
          echo "All CI checks passed via ci-framework!"
